---
title: "Assignment 1"
output: html_document
date: "2022-09-26"
---
#Laktatterskel - sykkel



```{r}
lac_data %>%
  filter(time == "pre") %>%
  select(FP, sex, age, watt_4mmol, HF_4mmol) %>%
  group_by(sex) %>%
```


#Gjennomsnitt
Gjennomsnitt av resultatene ved 4mmol laktat. Laktat eller melkesyre i blodet refereres til mangel på oksygentilførsel til deler av kroppen under arbeid (Vinnes, 2022). Laktatterskel kan eksempelvis forklare hvilken intensitet du kan holde over en gitt periode, og unngå utmattelse. 

```{r setup, include=FALSE}
lac_data %>%
summarise(MeanAge = mean(age),
            sdAge = sprintf("(%.2f)", sd(age)),
            MeanWatt_4mmol = mean(watt_4mmol),
            sdWatt_4mmol = sprintf("(%.2f)", sd(watt_4mmol)),
            MeanHF_4mmol = mean(HF_4mmol),
            sdHF_4mmol = sprintf("(%.2f)", sd(HF_4mmol)), n = n()) %>%
  gt(caption = "Subjects") %>%
  cols_label(MeanAge = "Age",
             sdAge = "",
             MeanWatt_4mmol = "Watt_4mmol",
             sdWatt_4mmol = "",
             MeanHF_4mmol = "HF_4mmol",
             sdHF_4mmol = "",
             n = "Participants",
             sex = "Sex")

```


# Gjennomsnitt av deltakere
```{r}
library(readxl)
lac_data <- read_excel("data/lac_data.xlsx", na = "NA")
View(lac_data)

lac_data %>%
  filter(time == "pre") %>%
  select(FP, sex, age, weight, height) %>%
  group_by(sex) %>%
  summarise(MeanAge = mean(age),
            sdAge = sprintf("(%.2f)", sd(age)),
            MeanHeight = mean(height),
            sdHeight = sprintf("(%.2f)", sd(height)),
            MeanWeight = mean(weight),
            sdWeight = sprintf("(%.2f)", sd(weight)), n = n()) %>%
  gt(caption = "Subjects") %>%
  cols_label(MeanAge = "Age",
             sdAge = "",
             MeanHeight = "Height",
             sdHeight = "",
             MeanWeight = "Weight",
             sdWeight = "",
             n = "Participants",
             sex = "Sex")
```

#Watt ved 4mmol
Fordeling basert på deltaker og kjønn.
```{r}
library(ggplot2)
library(tidyverse)

lac_data %>% 
  mutate(time = factor(time, levels = 
                  c("pre", "post"))) %>%
  ggplot(aes(y = watt_4mmol, 
             x = time,
             color = sex)) + 
  geom_point() 
```


#Watt og hjertefrekvens ved 4mmol
```{r}
#| message: false
#| warning: false
#| echo: false


lac_data <- read_excel("data/lac_data.xlsx", na = "NA")
lac_data %>%
  select(FP, sex, time, watt_4mmol, HF_4mmol) %>%
  pivot_wider(names_from = time, 
              values_from = c(watt_4mmol, HF_4mmol)) %>%
  
  mutate(watt_diff = watt_4mmol_post - watt_4mmol_pre, 
         hf_diff = HF_4mmol_post - HF_4mmol_pre) %>%
  
  group_by(sex) %>%
  
  summarise(watt.s = sd(watt_diff, na.rm = TRUE), 
            hf.s = sd(hf_diff, na.rm = TRUE),
            watt.m = mean(c(watt_4mmol_pre, watt_4mmol_post), na.rm = TRUE), 
            hf.m = mean(c(HF_4mmol_pre, HF_4mmol_post), na.rm = TRUE), 
            watt.te = watt.s / sqrt(2), 
            hf.te = hf.s / sqrt(2), 
            watt.cv = 100 * (watt.te / watt.m), 
            hf.cv = 100 * (hf.te / hf.m), 
            n = n())

```

